{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/darija-dictionary.schema.json",
  "title": "Darija Dictionary (Simplified, Draft-07)",
  "type": "array",
  "items": { "$ref": "#/definitions/DictionaryEntry" },

  "definitions": {
    "Gender": {
      "type": "string",
      "enum": ["masculine", "feminine", "common", "none"]
    },
    "GrammaticalNumber": {
      "type": "string",
      "enum": ["singular", "plural"]
    },
    "WordClass": {
      "type": "string",
      "enum": ["noun", "verb", "adjective", "adverb", "preposition", "pronoun", "number", "ordinal_number", "fraction", "conjunction"]
    },

    "RelationType": {
      "type": "string",
      "enum": ["same_root", "singular_of", "plural_of", "feminine_form_of", "adjective_form_of", "see_also"]
    },

    "RelatedEntry": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "entryId": { "type": "string", "minLength": 1 },
        "type": { "$ref": "#/definitions/RelationType" },
        "note": { "type": "string" }
      },
      "required": ["entryId", "type"]
    },

    "WordForm": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "latin": { "type": "string", "minLength": 1 },
        "gender": { "$ref": "#/definitions/Gender" },
        "number": { "$ref": "#/definitions/GrammaticalNumber" },
        "isLemma": { "type": "boolean", "default": false },
        "notes": { "type": "string" }
      },
      "required": ["latin"]
    },

    "DictionaryEntry": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "originalId": { "type": "string" },

        "darija_ar": { "type": "string", "minLength": 1 },
        "darija_latin": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "minItems": 1,
          "uniqueItems": true
        },

        "class": { "$ref": "#/definitions/WordClass" },

        "en": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "minItems": 1,
          "uniqueItems": true
        },
        "de": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "minItems": 1,
          "uniqueItems": true
        },

        "gender": { "$ref": "#/definitions/Gender" },
        "number": { "$ref": "#/definitions/GrammaticalNumber" },

        "forms": {
          "type": "array",
          "items": { "$ref": "#/definitions/WordForm" }
        },

        "related": {
          "type": "array",
          "items": { "$ref": "#/definitions/RelatedEntry" }
        },
        "category": { "type": "string" },
        "category_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "frequency_score": { "type": "integer" },
        "is_daily_darija": { "type": "boolean", "default": false },
        "is_standard_arabic": { "type": "boolean", "default": false },
        "user_summary_de": { "type": "string" },
        "user_summary_en": { "type": "string" },
        "reviewed": { "type": "boolean", "default": false },
        "include": { "type": "boolean", "default": true },
        "validation": { "type": "object" }
      },
      "required": ["id", "darija_ar", "darija_latin", "class", "en", "de"],
      "allOf": [
        {
          "if": { "properties": { "class": { "const": "noun" } } },
          "then": {
            "properties": {
              "category": {
                "type": "string",
                "enum": [
                  "abstract_concepts", "animals_plants", "colors", "communication", "culture_leisure", "feelings_emotions", "food_drink", "objects_tools", "other", "people_professions", "places_environment", "religion_belief"
                ]
              }
            }
          }
        },
        {
          "if": { "properties": { "class": { "const": "verb" } } },
          "then": {
            "properties": {
              "category": {
                "type": "string",
                "enum": [
                  "change_transformation", "communication", "condition_state", "creation_work", "culture_leisure", "existence", "feelings_emotions", "movement", "other", "perception", "religious_actions", "thinking_planning", "possession"
                ]
              }
            }
          }
        },
        {
          "if": { "properties": { "class": { "const": "adjective" } } },
          "then": {
            "properties": {
              "category": {
                "type": "string",
                "enum": [
                  "abstract_concepts", "colors", "condition_state", "evaluation_quality", "feelings_mood", "food_drink", "other", "perception", "quantity_intensity", "religious_descriptions", "size_shape", "temperature"
                ]
              }
            }
          }
        },
        {
          "if": { "properties": { "class": { "not": { "enum": ["noun", "verb", "adjective"] } } } },
          "then": {
            "properties": {
              "category": { "type": "string", "enum": ["other"] }
            }
          }
        }
      ]
    }
  }
}
